if(verbose) cat( "Reading... \n")
name_ds <- h5::openDataSet(.Object = file, datasetname = dataset)
dset <- h5::readDataSet(.Object = name_ds)
if(verbose) cat( "Selecting month... \n")
dset <- dset[month, 1, 1800:1, ]
if(verbose) cat("dimensions: ", dim(a), '\n')
if(show.attribute){
latr <- h5::list.attributes(file)
choice <- utils::menu(latr, title="Choose attribute")
nds <- latr[choice]
at <- h5::openAttribute(.Object = file, attributename = nds)
bt <- h5::readAttribute(at)
if(verbose) cat("Attribute Name: ", at@name,  "\nValue: ",bt, "\n")
}
return(a)
h5::h5close(file)
}
e <- read_edgar(path)
#' @param verbose Logical; Do you want more information?
#' @return array of EDGAR emissions by month.
#' @importFrom  h5 h5file list.datasets list.attributes openAttribute readAttribute
#' @importFrom utils menu object.size
#' @export
#' @examples \dontrun{
#' # do not run
#' path  = "~/Downloads/EDGAR-HTAP_TRANSPORT_2010.h5"
#' e <- read_edgar(path)
#' }
read_edgar <- function(path,
dataset,
show.attribute = FALSE,
month = 1,
verbose = TRUE){
file <- h5::h5file(name = path, mode = 'r')
if(missing(month)){
choice <- utils::menu(1:12, title="Choose month")
month <- (1:12)[choice]
}
ds <- h5::list.datasets(file, recursive = TRUE)
ds <- substr(x = ds, start = 2, nchar(ds))
if(verbose) print(file)
if(verbose) cat("Datasets:\n",
ds, "\n")
if(verbose) cat("Attributes:\n",
h5::list.attributes(file), "\n")
if(missing(dataset)){
choice <- utils::menu(ds, title="Choose dataset")
dataset <- ds[choice]
}
if(verbose) cat( "Reading... \n")
name_ds <- h5::openDataSet(.Object = file, datasetname = dataset)
dset <- h5::readDataSet(.Object = name_ds)
if(verbose) cat( "Selecting month... \n")
dset <- dset[month, 1, 1800:1, ]
if(verbose) cat("dimensions: ", dim(dset), '\n')
if(show.attribute){
latr <- h5::list.attributes(file)
choice <- utils::menu(latr, title="Choose attribute")
nds <- latr[choice]
at <- h5::openAttribute(.Object = file, attributename = nds)
bt <- h5::readAttribute(at)
if(verbose) cat("Attribute Name: ", at@name,  "\nValue: ",bt, "\n")
}
return(a)
h5::h5close(file)
}
e <- read_edgar(path)
#' @param verbose Logical; Do you want more information?
#' @return array of EDGAR emissions by month.
#' @importFrom  h5 h5file list.datasets list.attributes openAttribute readAttribute
#' @importFrom utils menu object.size
#' @export
#' @examples \dontrun{
#' # do not run
#' path  = "~/Downloads/EDGAR-HTAP_TRANSPORT_2010.h5"
#' e <- read_edgar(path)
#' }
read_edgar <- function(path,
dataset,
show.attribute = FALSE,
month = 1,
verbose = TRUE){
file <- h5::h5file(name = path, mode = 'r')
if(missing(month)){
choice <- utils::menu(1:12, title="Choose month")
month <- (1:12)[choice]
}
ds <- h5::list.datasets(file, recursive = TRUE)
ds <- substr(x = ds, start = 2, nchar(ds))
if(verbose) print(file)
if(verbose) cat("Datasets:\n",
ds, "\n")
if(verbose) cat("Attributes:\n",
h5::list.attributes(file), "\n")
if(missing(dataset)){
choice <- utils::menu(ds, title="Choose dataset")
dataset <- ds[choice]
}
if(verbose) cat( "Reading... \n")
name_ds <- h5::openDataSet(.Object = file, datasetname = dataset)
dset <- h5::readDataSet(.Object = name_ds)
if(verbose) cat( "Selecting month... \n")
dset <- dset[month, 1, 1800:1, ]
if(verbose) cat("dimensions: ", dim(dset), '\n')
if(show.attribute){
latr <- h5::list.attributes(file)
choice <- utils::menu(latr, title="Choose attribute")
nds <- latr[choice]
at <- h5::openAttribute(.Object = file, attributename = nds)
bt <- h5::readAttribute(at)
if(verbose) cat("Attribute Name: ", at@name,  "\nValue: ",bt, "\n")
}
return(dset)
h5::h5close(file)
}
e <- read_edgar(path)
#' @param verbose Logical; Do you want more information?
#' @return array of EDGAR emissions by month.
#' @importFrom  h5 h5file list.datasets list.attributes openAttribute readAttribute
#' @importFrom utils menu object.size
#' @export
#' @examples \dontrun{
#' # do not run
#' path  = "~/Downloads/EDGAR-HTAP_TRANSPORT_2010.h5"
#' e <- read_edgar(path)
#' }
read_edgar <- function(path,
dataset,
show.attribute = FALSE,
month = 1,
verbose = TRUE){
file <- h5::h5file(name = path, mode = 'r')
if(missing(month)){
choice <- utils::menu(1:12, title="Choose month")
month <- (1:12)[choice]
}
ds <- h5::list.datasets(file, recursive = TRUE)
ds <- substr(x = ds, start = 2, nchar(ds))
if(verbose) print(file)
if(verbose) cat("Datasets:\n",
ds, "\n")
if(verbose) cat("Attributes:\n",
h5::list.attributes(file), "\n")
if(missing(dataset)){
choice <- utils::menu(ds, title="Choose dataset")
dataset <- ds[choice]
}
if(verbose) cat( "Reading... \n")
name_ds <- h5::openDataSet(.Object = file, datasetname = dataset)
dset <- h5::readDataSet(.Object = name_ds)[month, 1, 1800:1, ]
if(verbose) cat("dimensions: ", dim(dset), '\n')
if(show.attribute){
latr <- h5::list.attributes(file)
choice <- utils::menu(latr, title="Choose attribute")
nds <- latr[choice]
at <- h5::openAttribute(.Object = file, attributename = nds)
bt <- h5::readAttribute(at)
if(verbose) cat("Attribute Name: ", at@name,  "\nValue: ",bt, "\n")
}
return(dset)
h5::h5close(file)
}
e <- read_edgar(path)
dim(e)
stars::st_as_stars(e)
plot(stars::st_as_stars(e))
#' @param verbose Logical; Do you want more information?
#' @return array of EDGAR emissions by month.
#' @importFrom  h5 h5file list.datasets list.attributes openAttribute readAttribute
#' @importFrom utils menu object.size
#' @export
#' @examples \dontrun{
#' # do not run
#' path  = "~/Downloads/EDGAR-HTAP_TRANSPORT_2010.h5"
#' e <- read_edgar(path)
#' }
read_edgar <- function(path,
dataset,
show.attribute = FALSE,
month = 1,
verbose = TRUE){
file <- h5::h5file(name = path, mode = 'r')
if(missing(month)){
choice <- utils::menu(1:12, title="Choose month")
month <- (1:12)[choice]
}
ds <- h5::list.datasets(file, recursive = TRUE)
ds <- substr(x = ds, start = 2, nchar(ds))
if(verbose) print(file)
if(verbose) cat("Datasets:\n",
ds, "\n")
if(verbose) cat("Attributes:\n",
h5::list.attributes(file), "\n")
if(missing(dataset)){
choice <- utils::menu(ds, title="Choose dataset")
dataset <- ds[choice]
}
if(verbose) cat( "Reading... \n")
name_ds <- h5::openDataSet(.Object = file, datasetname = dataset)
dset <- h5::readDataSet(.Object = name_ds)[month, 1, , ]
if(verbose) cat("dimensions: ", dim(dset), '\n')
if(show.attribute){
latr <- h5::list.attributes(file)
choice <- utils::menu(latr, title="Choose attribute")
nds <- latr[choice]
at <- h5::openAttribute(.Object = file, attributename = nds)
bt <- h5::readAttribute(at)
if(verbose) cat("Attribute Name: ", at@name,  "\nValue: ",bt, "\n")
}
return(dset)
h5::h5close(file)
}
e <- read_edgar(path)
plot(stars::st_as_stars(e))
#' @param verbose Logical; Do you want more information?
#' @return array of EDGAR emissions by month.
#' @importFrom  h5 h5file list.datasets list.attributes openAttribute readAttribute
#' @importFrom utils menu object.size
#' @export
#' @examples \dontrun{
#' # do not run
#' path  = "~/Downloads/EDGAR-HTAP_TRANSPORT_2010.h5"
#' e <- read_edgar(path)
#' }
read_edgar <- function(path,
dataset,
show.attribute = FALSE,
month = 1,
verbose = TRUE){
file <- h5::h5file(name = path, mode = 'r')
if(missing(month)){
choice <- utils::menu(1:12, title="Choose month")
month <- (1:12)[choice]
}
ds <- h5::list.datasets(file, recursive = TRUE)
ds <- substr(x = ds, start = 2, nchar(ds))
if(verbose) print(file)
if(verbose) cat("Datasets:\n",
ds, "\n")
if(verbose) cat("Attributes:\n",
h5::list.attributes(file), "\n")
if(missing(dataset)){
choice <- utils::menu(ds, title="Choose dataset")
dataset <- ds[choice]
}
if(verbose) cat( "Reading... \n")
name_ds <- h5::openDataSet(.Object = file, datasetname = dataset)
dset <- h5::readDataSet(.Object = name_ds)t([month, 1, 1800:1, ])
if(verbose) cat("dimensions: ", dim(dset), '\n')
if(show.attribute){
latr <- h5::list.attributes(file)
choice <- utils::menu(latr, title="Choose attribute")
nds <- latr[choice]
at <- h5::openAttribute(.Object = file, attributename = nds)
bt <- h5::readAttribute(at)
if(verbose) cat("Attribute Name: ", at@name,  "\nValue: ",bt, "\n")
}
return(dset)
h5::h5close(file)
}
#' @param verbose Logical; Do you want more information?
#' @return array of EDGAR emissions by month.
#' @importFrom  h5 h5file list.datasets list.attributes openAttribute readAttribute
#' @importFrom utils menu object.size
#' @export
#' @examples \dontrun{
#' # do not run
#' path  = "~/Downloads/EDGAR-HTAP_TRANSPORT_2010.h5"
#' e <- read_edgar(path)
#' }
read_edgar <- function(path,
dataset,
show.attribute = FALSE,
month = 1,
verbose = TRUE){
file <- h5::h5file(name = path, mode = 'r')
if(missing(month)){
choice <- utils::menu(1:12, title="Choose month")
month <- (1:12)[choice]
}
ds <- h5::list.datasets(file, recursive = TRUE)
ds <- substr(x = ds, start = 2, nchar(ds))
if(verbose) print(file)
if(verbose) cat("Datasets:\n",
ds, "\n")
if(verbose) cat("Attributes:\n",
h5::list.attributes(file), "\n")
if(missing(dataset)){
choice <- utils::menu(ds, title="Choose dataset")
dataset <- ds[choice]
}
if(verbose) cat( "Reading... \n")
name_ds <- h5::openDataSet(.Object = file, datasetname = dataset)
dset <- h5::readDataSet(.Object = name_ds)t([month, 1, 1800:1, ])
if(verbose) cat("dimensions: ", dim(dset), '\n')
if(show.attribute){
latr <- h5::list.attributes(file)
choice <- utils::menu(latr, title="Choose attribute")
nds <- latr[choice]
at <- h5::openAttribute(.Object = file, attributename = nds)
bt <- h5::readAttribute(at)
if(verbose) cat("Attribute Name: ", at@name,  "\nValue: ",bt, "\n")
}
return(dset)
h5::h5close(file)
}
#' @param verbose Logical; Do you want more information?
#' @return array of EDGAR emissions by month.
#' @importFrom  h5 h5file list.datasets list.attributes openAttribute readAttribute
#' @importFrom utils menu object.size
#' @export
#' @examples \dontrun{
#' # do not run
#' path  = "~/Downloads/EDGAR-HTAP_TRANSPORT_2010.h5"
#' e <- read_edgar(path)
#' }
read_edgar <- function(path,
dataset,
show.attribute = FALSE,
month = 1,
verbose = TRUE){
file <- h5::h5file(name = path, mode = 'r')
if(missing(month)){
choice <- utils::menu(1:12, title="Choose month")
month <- (1:12)[choice]
}
ds <- h5::list.datasets(file, recursive = TRUE)
ds <- substr(x = ds, start = 2, nchar(ds))
if(verbose) print(file)
if(verbose) cat("Datasets:\n",
ds, "\n")
if(verbose) cat("Attributes:\n",
h5::list.attributes(file), "\n")
if(missing(dataset)){
choice <- utils::menu(ds, title="Choose dataset")
dataset <- ds[choice]
}
if(verbose) cat( "Reading... \n")
name_ds <- h5::openDataSet(.Object = file, datasetname = dataset)
dset <- h5::readDataSet(.Object = name_ds)[month, 1, 1800:1, ]
dset <- t(dset)
if(verbose) cat("dimensions: ", dim(dset), '\n')
if(show.attribute){
latr <- h5::list.attributes(file)
choice <- utils::menu(latr, title="Choose attribute")
nds <- latr[choice]
at <- h5::openAttribute(.Object = file, attributename = nds)
bt <- h5::readAttribute(at)
if(verbose) cat("Attribute Name: ", at@name,  "\nValue: ",bt, "\n")
}
return(dset)
h5::h5close(file)
}
month= 1
if(missing(month)){
choice <- utils::menu(1:12, title="Choose month")
month <- (1:12)[choice]
}
rm(month)
#' @param verbose Logical; Do you want more information?
#' @return array of EDGAR emissions by month.
#' @importFrom  h5 h5file list.datasets list.attributes openAttribute readAttribute
#' @importFrom utils menu object.size
#' @export
#' @examples \dontrun{
#' # do not run
#' path  = "~/Downloads/EDGAR-HTAP_TRANSPORT_2010.h5"
#' e <- read_edgar(path, month =1, )
#' }
read_edgar <- function(path,
month,
dataset,
show.attribute = FALSE,
verbose = TRUE){
file <- h5::h5file(name = path, mode = 'r')
if(missing(month)){
choice <- utils::menu(1:12, title="Choose month")
month <- (1:12)[choice]
}
ds <- h5::list.datasets(file, recursive = TRUE)
ds <- substr(x = ds, start = 2, nchar(ds))
if(verbose) print(file)
if(verbose) cat("Datasets:\n",
ds, "\n")
if(verbose) cat("Attributes:\n",
h5::list.attributes(file), "\n")
if(missing(dataset)){
choice <- utils::menu(ds, title="Choose dataset")
dataset <- ds[choice]
}
if(verbose) cat( "Reading... \n")
name_ds <- h5::openDataSet(.Object = file, datasetname = dataset)
dset <- h5::readDataSet(.Object = name_ds)[month, 1, 1800:1, ]
dset <- t(dset)
if(verbose) cat("dimensions: ", dim(dset), '\n')
if(show.attribute){
latr <- h5::list.attributes(file)
choice <- utils::menu(latr, title="Choose attribute")
nds <- latr[choice]
at <- h5::openAttribute(.Object = file, attributename = nds)
bt <- h5::readAttribute(at)
if(verbose) cat("Attribute Name: ", at@name,  "\nValue: ",bt, "\n")
}
return(dset)
h5::h5close(file)
}
path  = "~/Downloads/EDGAR-HTAP_TRANSPORT_2010.h5"
e <- read_edgar(path, month =1, )
e <- read_edgar(path, month =1, dataset = "PM2.5")
plot(stars::st_as_stars(e))
#' @param verbose Logical; Do you want more information?
#' @return array of EDGAR emissions by month.
#' @importFrom  h5 h5file list.datasets list.attributes openAttribute readAttribute
#' @importFrom utils menu object.size
#' @export
#' @examples \dontrun{
#' # do not run
#' path  = "~/Downloads/EDGAR-HTAP_TRANSPORT_2010.h5"
#' e <- read_edgar(path, month =1, dataset = "PM2.5")
#' }
read_edgar <- function(path,
month,
dataset,
show.attribute = FALSE,
verbose = TRUE){
file <- h5::h5file(name = path, mode = 'r')
if(missing(month)){
choice <- utils::menu(1:12, title="Choose month")
month <- (1:12)[choice]
}
ds <- h5::list.datasets(file, recursive = TRUE)
ds <- substr(x = ds, start = 2, nchar(ds))
if(verbose) print(file)
if(verbose) cat("Datasets:\n",
ds, "\n")
if(verbose) cat("Attributes:\n",
h5::list.attributes(file), "\n")
if(missing(dataset)){
choice <- utils::menu(ds, title="Choose dataset")
dataset <- ds[choice]
}
if(verbose) cat( "Reading... \n")
name_ds <- h5::openDataSet(.Object = file, datasetname = dataset)
dset <- h5::readDataSet(.Object = name_ds)[month, 1, 1800:1, ]
if(verbose) cat("Original dimensions: ", dim(dset), '\n')
dset <- dset[month, 1, 1800:1, ]
dset <- t(dset)
if(verbose) cat("dimensions: ", dim(dset), '\n')
if(show.attribute){
latr <- h5::list.attributes(file)
choice <- utils::menu(latr, title="Choose attribute")
nds <- latr[choice]
at <- h5::openAttribute(.Object = file, attributename = nds)
bt <- h5::readAttribute(at)
if(verbose) cat("Attribute Name: ", at@name,  "\nValue: ",bt, "\n")
}
return(dset)
h5::h5close(file)
}
e <- read_edgar(path, month =1, dataset = "PM2.5")
#' @param verbose Logical; Do you want more information?
#' @return array of EDGAR emissions by month.
#' @importFrom  h5 h5file list.datasets list.attributes openAttribute readAttribute
#' @importFrom utils menu object.size
#' @export
#' @examples \dontrun{
#' # do not run
#' path  = "~/Downloads/EDGAR-HTAP_TRANSPORT_2010.h5"
#' e <- read_edgar(path, month =1, dataset = "PM2.5")
#' }
read_edgar <- function(path,
month,
dataset,
show.attribute = FALSE,
verbose = TRUE){
file <- h5::h5file(name = path, mode = 'r')
if(missing(month)){
choice <- utils::menu(1:12, title="Choose month")
month <- (1:12)[choice]
}
ds <- h5::list.datasets(file, recursive = TRUE)
ds <- substr(x = ds, start = 2, nchar(ds))
if(verbose) print(file)
if(verbose) cat("Datasets:\n",
ds, "\n")
if(verbose) cat("Attributes:\n",
h5::list.attributes(file), "\n")
if(missing(dataset)){
choice <- utils::menu(ds, title="Choose dataset")
dataset <- ds[choice]
}
if(verbose) cat( "Reading... \n")
name_ds <- h5::openDataSet(.Object = file, datasetname = dataset)
dset <- h5::readDataSet(.Object = name_ds)
if(verbose) cat("Original dimensions: ", dim(dset), '\n')
dset <- dset[month, 1, 1800:1, ]
dset <- t(dset)
if(verbose) cat("dimensions: ", dim(dset), '\n')
if(show.attribute){
latr <- h5::list.attributes(file)
choice <- utils::menu(latr, title="Choose attribute")
nds <- latr[choice]
at <- h5::openAttribute(.Object = file, attributename = nds)
bt <- h5::readAttribute(at)
if(verbose) cat("Attribute Name: ", at@name,  "\nValue: ",bt, "\n")
}
return(dset)
h5::h5close(file)
}
e <- read_edgar(path, month =1, dataset = "PM2.5")
dim(t(matrix(NA, ncol = 1800, nrow = 3600, byrow = TRUE)))
e <- read_edgar(path, dataset = "PM2.5")
